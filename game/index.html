<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Automation Runner | ×˜×™××•×Ÿ ×•×¤×•××‘×”</title>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ—</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;900&family=Rubik:wght@700;900&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <style>
        :root {
            --amber: #ffb900;
            --dark: #050505;
            --green: #25D366;
            --red: #ff4b4b;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; user-select: none; touch-action: none; }
        body { 
            font-family: 'Heebo', sans-serif; 
            background-color: var(--dark); 
            color: white; 
            height: 100vh;
            display: flex; overflow: hidden;
        }

        /* --- Layout --- */
        .main-wrapper {
            display: grid;
            grid-template-columns: 1fr 350px;
            width: 100%;
            height: 100%;
        }

        /* --- YouTube Sidebar --- */
        .youtube-sidebar {
            background: #111;
            border-right: 1px solid #222;
            display: flex; flex-direction: column;
            padding: 20px; z-index: 10;
        }
        .youtube-sidebar h3 { font-family: 'Rubik'; margin-bottom: 15px; color: var(--amber); font-size: 1.1rem; }
        #yt-frame { width: 100%; aspect-ratio: 16/9; border-radius: 15px; border: 1px solid #333; }
        .yt-presets { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; }
        .preset-btn { background: #222; border: 1px solid #333; color: #888; padding: 10px; border-radius: 8px; font-size: 0.8rem; cursor: pointer; transition: 0.3s; }
        .preset-btn:hover { background: #333; color: white; }

        /* --- Game Area --- */
        #game-container {
            flex: 1;
            position: relative;
            background: linear-gradient(to bottom, #050505, #111);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }

        canvas {
            background: #000;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            max-width: 95%;
            max-height: 70vh;
            border: 2px solid #222;
        }

        /* UI Overlays */
        .game-ui {
            position: absolute; top: 40px; width: 90%;
            display: flex; justify-content: space-between;
            font-family: 'Rubik'; font-size: 1.5rem; font-weight: 900;
            pointer-events: none; z-index: 100;
        }
        .score-box span { color: var(--amber); }

        #start-screen, #game-over-screen {
            position: absolute; inset: 0; background: rgba(0,0,0,0.85);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 200; text-align: center; backdrop-filter: blur(10px);
        }

        .btn {
            padding: 16px 40px; border-radius: 50px; border: none;
            background: var(--amber); color: black; font-weight: 900;
            font-size: 1.2rem; cursor: pointer; transition: 0.3s;
            margin-top: 20px;
        }
        .btn:hover { transform: scale(1.05); box-shadow: 0 0 20px rgba(255,185,0,0.4); }

        .instructions { color: #666; font-size: 0.9rem; margin-top: 20px; }

        @media (max-width: 1000px) {
            .main-wrapper { grid-template-columns: 1fr; }
            .youtube-sidebar { display: none; }
        }
    </style>
</head>
<body>

    <div class="main-wrapper">
        <!-- Game Area -->
        <div id="game-container">
            <div class="game-ui">
                <div class="score-box">Score: <span id="score">0</span></div>
                <div class="score-box">Best: <span id="best">0</span></div>
            </div>

            <!-- Start Screen -->
            <div id="start-screen">
                <div style="font-size: 5rem; margin-bottom: 10px;">ğŸ—</div>
                <h1 style="font-family:'Rubik'; font-size: 3rem; color: var(--amber);">AUTOMATION RUNNER</h1>
                <p>××¡×¤×• × ×ª×•× ×™×, ×”×™×× ×¢×• ××¢×‘×•×“×” ×™×“× ×™×ª!</p>
                <button class="btn" onclick="startGame()">×”×ª×—×œ ×¨×™×¦×” ğŸš€</button>
                <p class="instructions">×¨×•×•×— ××• ×œ×—×™×¦×”: ×§×¤×™×¦×” | ×§×¤×™×¦×” ×›×¤×•×œ×” × ×ª××›×ª</p>
            </div>

            <!-- Game Over Screen -->
            <div id="game-over-screen" style="display: none;">
                <h1 style="font-size: 3.5rem; color: var(--red);">×”×¢×¡×§ ×§×¨×¡! ğŸ“‰</h1>
                <p id="final-score-text" style="font-size: 1.5rem; margin: 10px 0;"></p>
                <button class="btn" onclick="startGame()">× ×¡×” ×©×•×‘ ğŸ”„</button>
                <a href="../" style="margin-top: 20px; color: #555; text-decoration: none; font-weight: bold;">×—×–×¨×” ×œ××ª×¨</a>
            </div>

            <canvas id="gameCanvas"></canvas>
        </div>

        <!-- YouTube Sidebar -->
        <aside class="youtube-sidebar">
            <h3>ğŸµ ×¤×œ×™×™×œ×™×¡×˜ ×¢×‘×•×“×”</h3>
            <iframe id="yt-frame" src="https://www.youtube.com/embed/jfKfPfyJRdk" frameborder="0" allow="autoplay; encrypted-media"></iframe>
            <div class="yt-presets">
                <button class="preset-btn" onclick="changeVid('jfKfPfyJRdk')">Lo-Fi â˜•</button>
                <button class="preset-btn" onclick="changeVid('17mYv7-O_t8')">×’'×•× ×’×œ ğŸŒ´</button>
                <button class="preset-btn" onclick="changeVid('S_MOd40zlYU')">Focus</button>
                <button class="preset-btn" onclick="changeVid('5qap5aO4i9A')">Lofi Hip Hop</button>
            </div>
        </aside>
    </div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const scoreEl = document.getElementById('score');
    const bestEl = document.getElementById('best');
    
    // --- Game State ---
    let score = 0;
    let highScore = localStorage.getItem('pumbaaRunnerBest') || 0;
    bestEl.innerText = highScore;
    let gameSpeed = 5;
    let isPlaying = false;
    let frame = 0;
    let obstacles = [];
    let items = [];

    function resize() {
        canvas.width = 800;
        canvas.height = 400;
    }
    resize();

    // --- Player Object ---
    const pumbaa = {
        x: 80, y: 300, w: 60, h: 60,
        dy: 0, jumpForce: -15, gravity: 0.8,
        grounded: false, jumps: 0,
        rotation: 0,
        update() {
            if (this.y + this.h < canvas.height - 40) {
                this.dy += this.gravity;
                this.grounded = false;
            } else {
                this.dy = 0;
                this.y = canvas.height - 40 - this.h;
                this.grounded = true;
                this.jumps = 0;
            }
            this.y += this.dy;
            this.rotation = this.grounded ? 0 : this.dy * 0.05;
            this.draw();
        },
        draw() {
            ctx.save();
            ctx.translate(this.x + this.w/2, this.y + this.h/2);
            ctx.rotate(this.rotation);
            ctx.font = '50px serif';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('ğŸ—', 0, 0);
            ctx.restore();
        },
        jump() {
            if (this.jumps < 2) {
                this.dy = this.jumpForce;
                this.jumps++;
            }
        }
    };

    // --- Obstacles & Items ---
    class GameObject {
        constructor(x, y, w, h, char, color) {
            this.x = x; this.y = y; this.w = w; this.h = h; this.char = char; this.color = color;
        }
        draw() {
            ctx.font = `${this.w}px serif`;
            ctx.fillText(this.char, this.x, this.y + this.h);
        }
        update() {
            this.x -= gameSpeed;
            this.draw();
        }
    }

    function startGame() {
        document.getElementById('start-screen').style.display = 'none';
        document.getElementById('game-over-screen').style.display = 'none';
        score = 0; gameSpeed = 6; frame = 0;
        obstacles = []; items = [];
        isPlaying = true;
        animate();
    }

    function gameOver() {
        isPlaying = false;
        document.getElementById('game-over-screen').style.display = 'flex';
        document.getElementById('result-score').innerText = Math.floor(score);
        if (score > highScore) {
            highScore = Math.floor(score);
            localStorage.setItem('pumbaaRunnerBest', highScore);
            bestEl.innerText = highScore;
        }
    }

    function changeVid(id) { document.getElementById('yt-frame').src = `https://www.youtube.com/embed/${id}?autoplay=1`; }

    function animate() {
        if (!isPlaying) return;
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Draw Floor
        ctx.fillStyle = '#222';
        ctx.fillRect(0, canvas.height - 40, canvas.width, 40);
        ctx.strokeStyle = var(--amber);
        ctx.beginPath(); ctx.moveTo(0, canvas.height-40); ctx.lineTo(canvas.width, canvas.height-40); ctx.stroke();

        pumbaa.update();

        // Spawn Logic
        if (frame % 80 === 0) {
            obstacles.push(new GameObject(canvas.width, canvas.height - 80, 40, 40, 'ğŸŒµ', 'red'));
        }
        if (frame % 120 === 0) {
            items.push(new GameObject(canvas.width, canvas.height - 150 - Math.random()*100, 35, 35, 'ğŸ’', 'green'));
        }

        // Update Obstacles
        obstacles.forEach((obs, i) => {
            obs.update();
            if (pumbaa.x < obs.x + 30 && pumbaa.x + 30 > obs.x && pumbaa.y < obs.y + 30 && pumbaa.y + 30 > obs.y) {
                gameOver();
            }
            if (obs.x < -50) obstacles.splice(i, 1);
        });

        // Update Items
        items.forEach((item, i) => {
            item.update();
            if (pumbaa.x < item.x + 40 && pumbaa.x + 40 > item.x && pumbaa.y < item.y + 40 && pumbaa.y + 40 > item.y) {
                score += 500;
                items.splice(i, 1);
                gsap.to(scoreEl, { scale: 1.5, duration: 0.1, yoyo: true, repeat: 1 });
            }
            if (item.x < -50) items.splice(i, 1);
        });

        score += 1;
        scoreEl.innerText = Math.floor(score);
        gameSpeed += 0.001;
        frame++;
        requestAnimationFrame(animate);
    }

    // Controls
    window.addEventListener('keydown', (e) => { if (e.code === 'Space') pumbaa.jump(); });
    window.addEventListener('touchstart', () => pumbaa.jump());
    window.addEventListener('mousedown', () => pumbaa.jump());
</script>
</body>
</html>
