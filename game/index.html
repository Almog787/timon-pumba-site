<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pumbaa Hit PRO | ×˜×™××•×Ÿ ×•×¤×•××‘×”</title>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ—</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;900&family=Rubik:wght@700;900&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <style>
        :root {
            --amber: #ffb900;
            --dark: #050505;
            --green: #25D366;
            --red: #ff4b4b;
            --blue: #00a8ff;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; user-select: none; touch-action: none; }
        body { 
            font-family: 'Heebo', sans-serif; 
            background-color: var(--dark); 
            color: white; 
            height: 100vh;
            display: flex; flex-direction: column; overflow: hidden;
        }

        header { 
            padding: 15px 5%; background: #111; 
            display: flex; justify-content: space-between; align-items: center; 
            border-bottom: 1px solid #333; z-index: 100;
        }
        .logo { font-family: 'Rubik'; font-weight: 900; color: white; text-decoration: none; }

        #game-container {
            flex: 1; position: relative; background: linear-gradient(to bottom, #001d3d, #003566);
            display: flex; align-items: center; justify-content: center; overflow: hidden;
        }

        canvas { display: block; width: 100%; height: 100%; }

        /* HUD */
        .hud {
            position: absolute; top: 20px; width: 100%; padding: 0 30px;
            display: flex; justify-content: space-between; font-family: 'Rubik';
            font-size: 1.2rem; font-weight: 900; pointer-events: none; z-index: 10;
        }

        /* Power Meter */
        #launch-ui {
            position: absolute; bottom: 40px; left: 50%; transform: translateX(-50%);
            text-align: center; z-index: 20; background: rgba(0,0,0,0.7); padding: 20px; border-radius: 25px; border: 1px solid #444;
        }
        .meter-bg { width: 250px; height: 20px; background: #222; border-radius: 10px; overflow: hidden; border: 2px solid white; margin: 10px 0; }
        #meter-fill { width: 0%; height: 100%; background: linear-gradient(to right, #25D366, #ffb900, #ff4b4b); }

        /* Game Over */
        #game-over {
            position: absolute; inset: 0; background: rgba(0,0,0,0.9);
            display: none; flex-direction: column; align-items: center; justify-content: center;
            z-index: 200; text-align: center; backdrop-filter: blur(10px);
        }

        .btn {
            padding: 16px 45px; border-radius: 50px; border: none;
            background: var(--amber); color: black; font-weight: 900;
            font-size: 1.2rem; cursor: pointer; transition: 0.3s;
        }
        .btn:hover { transform: scale(1.1); box-shadow: 0 0 20px var(--amber); }

        .instr { position: absolute; bottom: 10px; color: rgba(255,255,255,0.4); font-size: 0.8rem; width: 100%; text-align: center; }
    </style>
</head>
<body>

    <header>
        <a href="../" class="logo">PUMBAA<span>HIT</span></a>
        <div style="font-size: 0.9rem;">×©×™×: <span id="best-dist" style="color:var(--amber)">0</span> ×'</div>
    </header>

    <div id="game-container">
        <div class="hud">
            <div>××¨×—×§: <span id="dist-val" style="color:var(--amber)">0</span> ×'</div>
            <div id="speed-hud" style="color:var(--blue)">××”×™×¨×•×ª: 0</div>
        </div>

        <div id="launch-ui">
            <p style="font-weight: bold; color: white; letter-spacing: 1px;">×ª×–××•×Ÿ ×—×‘×˜×”!</p>
            <div class="meter-bg"><div id="meter-fill"></div></div>
        </div>

        <div id="game-over">
            <h1 style="font-size: 3.5rem; color: var(--amber); margin-bottom: 10px;">× ×—×™×ª×”! ğŸ§</h1>
            <p id="final-dist-text" style="font-size: 1.8rem; margin-bottom: 30px;"></p>
            <button class="btn" onclick="resetGame()">×—×‘×˜×” ×—×•×–×¨×ª ğŸ—</button>
            <a href="../" style="margin-top: 20px; color: #666; text-decoration: none; font-weight: bold; display: block;">×—×–×¨×” ×œ××ª×¨</a>
        </div>

        <canvas id="gameCanvas"></canvas>
        <div class="instr">×‘××•×•×™×¨: ×œ×—×™×¦×” ×œ-SLAM âš¡ | ×¤×’×¢ ×‘-ğŸ¦­, ğŸš€, â˜ï¸ ×•×”×™×–×”×¨ ×-ğŸ¦…</div>
    </div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const meterFill = document.getElementById('meter-fill');
    const distVal = document.getElementById('dist-val');
    const bestVal = document.getElementById('best-dist');
    const speedHud = document.getElementById('speed-hud');
    const gameOverScreen = document.getElementById('game-over');
    const launchUI = document.getElementById('launch-ui');

    let width, height;
    let gameState = 'LAUNCH'; 
    let score = 0;
    let highScore = localStorage.getItem('pumbaaHitBest') || 0;
    bestVal.innerText = highScore;

    let power = 0;
    let powerDir = 1;
    let cameraX = 0;
    let shake = 0;

    const penguin = {
        x: 100, y: 0, vx: 0, vy: 0,
        rotation: 0, gravity: 0.28, friction: 0.994,
        isSlamming: false, trail: []
    };

    const objects = [];
    const particles = [];

    class Particle {
        constructor(x, y, color) {
            this.x = x; this.y = y;
            this.color = color;
            this.vx = (Math.random() - 0.5) * 10;
            this.vy = (Math.random() - 0.5) * 10;
            this.alpha = 1;
            this.size = Math.random() * 5 + 2;
        }
        update() {
            this.x += this.vx; this.y += this.vy;
            this.alpha -= 0.02;
        }
        draw() {
            ctx.globalAlpha = this.alpha;
            ctx.fillStyle = this.color;
            ctx.beginPath(); ctx.arc(this.x - cameraX, this.y, this.size, 0, Math.PI*2); ctx.fill();
            ctx.globalAlpha = 1;
        }
    }

    function createExplosion(x, y, color, count = 10) {
        for(let i=0; i<count; i++) particles.push(new Particle(x, y, color));
    }

    function resize() {
        width = canvas.width = window.innerWidth;
        height = canvas.height = window.innerHeight - 80;
        if (gameState === 'LAUNCH') penguin.y = height - 100;
    }

    function spawnObjects(startX) {
        const types = ['SEAL', 'CLOUD', 'ROCKET', 'BIRD', 'BUG', 'TRAMPOLINE'];
        for (let i = 0; i < 8; i++) {
            const type = types[Math.floor(Math.random() * types.length)];
            objects.push({
                x: startX + i * 500 + Math.random() * 300,
                y: (type === 'SEAL' || type === 'TRAMPOLINE') ? height - 65 : 80 + Math.random() * (height - 250),
                type: type,
                active: true,
                emoji: { SEAL:'ğŸ¦­', CLOUD:'â˜ï¸', ROCKET:'ğŸš€', BIRD:'ğŸ¦…', BUG:'ğŸ›', TRAMPOLINE:'ğŸª' }[type]
            });
        }
    }

    function resetGame() {
        gameState = 'LAUNCH';
        score = 0; cameraX = 0; power = 0;
        penguin.x = 100; penguin.y = height - 100;
        penguin.vx = 0; penguin.vy = 0; penguin.rotation = 0;
        penguin.isSlamming = false; penguin.trail = [];
        objects.length = 0; particles.length = 0;
        spawnObjects(800);
        gameOverScreen.style.display = 'none';
        launchUI.style.display = 'block';
    }

    function handleInput() {
        if (gameState === 'LAUNCH') {
            const p = power / 100;
            penguin.vx = 18 + (p * 35);
            penguin.vy = -12 - (p * 22);
            gameState = 'FLY';
            launchUI.style.display = 'none';
            shake = 10;
            createExplosion(penguin.x, penguin.y, '#fff', 20);
        } else if (gameState === 'FLY' && !penguin.isSlamming) {
            penguin.vy = 22; 
            penguin.isSlamming = true;
        }
    }

    function update() {
        ctx.save();
        if (shake > 0) {
            ctx.translate((Math.random()-0.5)*shake, (Math.random()-0.5)*shake);
            shake *= 0.9;
        }

        ctx.clearRect(0, 0, width, height);

        if (gameState === 'LAUNCH') {
            power += 4.5 * powerDir;
            if (power > 100 || power < 0) powerDir *= -1;
            meterFill.style.width = power + '%';
        }

        if (gameState === 'FLY') {
            penguin.vy += penguin.gravity;
            penguin.vx *= penguin.friction;
            penguin.x += penguin.vx;
            penguin.y += penguin.vy;
            penguin.rotation += penguin.vx * 0.015;

            // Trail
            penguin.trail.push({x: penguin.x, y: penguin.y});
            if(penguin.trail.length > 15) penguin.trail.shift();

            cameraX = penguin.x - 150;

            // Ground hit
            if (penguin.y > height - 60) {
                penguin.y = height - 60;
                if (penguin.isSlamming) {
                    penguin.vy *= -0.6;
                    shake = 5;
                    createExplosion(penguin.x, penguin.y, '#fff');
                } else {
                    penguin.vy *= -0.3;
                }
                penguin.vx *= 0.85;
                penguin.isSlamming = false;

                if (penguin.vx < 0.6) {
                    gameState = 'END';
                    showGameOver();
                }
            }

            // Collisions
            objects.forEach(obj => {
                if (!obj.active) return;
                const dx = penguin.x - obj.x;
                const dy = penguin.y - obj.y;
                const dist = Math.sqrt(dx*dx + dy*dy);

                if (dist < 65) {
                    obj.active = false;
                    shake = 8;
                    switch(obj.type) {
                        case 'SEAL':
                            penguin.vy = penguin.isSlamming ? -28 : -20;
                            penguin.vx += 10;
                            createExplosion(obj.x, obj.y, '#00a8ff');
                            break;
                        case 'TRAMPOLINE':
                            penguin.vy = -35;
                            penguin.vx += 5;
                            createExplosion(obj.x, obj.y, '#ff4b4b');
                            break;
                        case 'CLOUD':
                            penguin.vx += 15;
                            penguin.vy -= 8;
                            createExplosion(obj.x, obj.y, '#fff');
                            break;
                        case 'ROCKET':
                            penguin.vx += 40;
                            penguin.vy = -5;
                            createExplosion(obj.x, obj.y, '#ffb900', 30);
                            break;
                        case 'BIRD':
                            penguin.vx *= 0.4;
                            createExplosion(obj.x, obj.y, '#555');
                            break;
                        case 'BUG':
                            score += 5000;
                            createExplosion(obj.x, obj.y, '#25D366');
                            break;
                    }
                    penguin.isSlamming = false;
                }
            });

            if (penguin.x > objects[objects.length - 4].x) spawnObjects(objects[objects.length - 1].x + 500);

            distVal.innerText = Math.floor(penguin.x / 10);
            speedHud.innerText = `××”×™×¨×•×ª: ${Math.floor(penguin.vx * 10)}`;
        }

        // Particles
        for(let i=particles.length-1; i>=0; i--) {
            particles[i].update();
            particles[i].draw();
            if(particles[i].alpha <= 0) particles.splice(i, 1);
        }

        draw();
        ctx.restore();
        requestAnimationFrame(update);
    }

    function draw() {
        // Ground
        ctx.fillStyle = '#001524';
        ctx.fillRect(0, height - 40, width, 40);

        // Objects
        objects.forEach(obj => {
            const sx = obj.x - cameraX;
            if (sx > -100 && sx < width + 100) {
                ctx.font = '55px serif';
                ctx.globalAlpha = obj.active ? 1 : 0.1;
                ctx.fillText(obj.emoji, sx - 25, obj.y + 20);
                ctx.globalAlpha = 1;
            }
        });

        // Trail
        if (gameState === 'FLY') {
            ctx.beginPath();
            ctx.strokeStyle = penguin.vx > 30 ? '#ff4b4b' : '#00a8ff';
            ctx.lineWidth = 4;
            penguin.trail.forEach((p, i) => {
                const tx = p.x - cameraX;
                if (i === 0) ctx.moveTo(tx, p.y);
                else ctx.lineTo(tx, p.y);
            });
            ctx.stroke();
        }

        // Pumbaa
        if (penguin.x < 600) {
            ctx.font = '90px serif';
            ctx.fillText('ğŸ—', 20 - cameraX, height - 35);
        }

        // Penguin
        ctx.save();
        ctx.translate(penguin.x - cameraX, penguin.y);
        ctx.rotate(penguin.rotation);
        ctx.font = '50px serif';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(penguin.isSlamming ? 'ğŸ”¥' : 'ğŸ§', 0, 0);
        ctx.restore();
    }

    function showGameOver() {
        const finalDist = Math.floor(penguin.x / 10);
        document.getElementById('final-dist-text').innerText = `×”×’×¢×ª ×œ××¨×—×§ ×©×œ ${finalDist} ××˜×¨×™×!`;
        gameOverScreen.style.display = 'flex';
        if (finalDist > highScore) {
            highScore = finalDist;
            localStorage.setItem('pumbaaHitBest', highScore);
            bestVal.innerText = highScore;
        }
    }

    window.addEventListener('mousedown', handleInput);
    window.addEventListener('touchstart', (e) => { e.preventDefault(); handleInput(); }, {passive: false});
    window.addEventListener('resize', resize);

    resize();
    resetGame();
</script>
</body>
</html>
